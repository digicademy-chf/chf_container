<VirtualHost *:80>
    PassEnv ADMIN_EMAIL HOSTNAME PROJECT_NAME

    # Set server info
	ServerAdmin ${ADMIN_EMAIL}
	ServerName ${HOSTNAME}

    # Set document root
	DocumentRoot /usr/local/apache2/uploads/
    Alias / /usr/local/apache2/uploads/

    # Provide WebDAV lock database
    DavLockDB /usr/local/apache2/var/DavLock

    # Set log locations
	ErrorLog /dev/stderr
    CustomLog /dev/stdout combined

    # Directory-specific settings
	<Directory /usr/local/apache2/uploads/>

        # Manage access
        Options Indexes FollowSymLinks
        AllowOverride None
        Require all granted

        # Turn on WebDAV
        Dav On

        # Manage authentication
        AuthType Basic
        AuthName "Restricted Access"
        AuthUserFile /usr/local/apache2/.htpasswd
        Require valid-user

    </Directory>

    # Fix redirect issues present in some WebDAV clients
    BrowserMatch "Microsoft Data Access Internet Publishing Provider" redirect-carefully
    BrowserMatch "MS FrontPage" redirect-carefully
    BrowserMatch "^WebDrive" redirect-carefully
    BrowserMatch "^WebDAVFS/1\.[012]" redirect-carefully
    BrowserMatch "^gnome-vfs/1\.0" redirect-carefully
    BrowserMatch "^gvfs/1" redirect-carefully
    BrowserMatch "^XML Spy" redirect-carefully
    BrowserMatch "^Dreamweaver-WebDAV-SCM1" redirect-carefully
    BrowserMatch " Konqueror/4" redirect-carefully
    BrowserMatch " Konqueror/5" redirect-carefully
    BrowserMatch " dolphin/" redirect-carefully

</VirtualHost>
<VirtualHost *:443>
    PassEnv ADMIN_EMAIL HOSTNAME PROJECT_NAME

    # Set server info
	ServerAdmin ${ADMIN_EMAIL}
	ServerName ${HOSTNAME}

    # Set document root
	DocumentRoot /usr/local/apache2/uploads/
    Alias / /usr/local/apache2/uploads/

    # Provide WebDAV lock database
    DavLockDB /usr/local/apache2/var/DavLock

    # Set log locations
	ErrorLog /dev/stderr
    CustomLog /dev/stdout combined

    # Set up SSL certificates
	SSLEngine On
    SSLCompression Off
	SSLCertificateFile /usr/local/apache2/ssl/cert.crt
	SSLCertificateKeyFile /usr/local/apache2/ssl/cert.key

    # Directory-specific settings
	<Directory /usr/local/apache2/uploads/>

        # Manage access
        Options Indexes FollowSymLinks
        AllowOverride None
        Require all granted

        # Turn on WebDAV
        Dav On

        # Manage authentication
        AuthType Basic
        AuthName "Restricted Access"
        AuthUserFile /usr/local/apache2/.htpasswd
        Require valid-user

    </Directory>

    # Fix redirect issues present in some WebDAV clients
    BrowserMatch "Microsoft Data Access Internet Publishing Provider" redirect-carefully
    BrowserMatch "MS FrontPage" redirect-carefully
    BrowserMatch "^WebDrive" redirect-carefully
    BrowserMatch "^WebDAVFS/1\.[012]" redirect-carefully
    BrowserMatch "^gnome-vfs/1\.0" redirect-carefully
    BrowserMatch "^gvfs/1" redirect-carefully
    BrowserMatch "^XML Spy" redirect-carefully
    BrowserMatch "^Dreamweaver-WebDAV-SCM1" redirect-carefully
    BrowserMatch " Konqueror/4" redirect-carefully
    BrowserMatch " Konqueror/5" redirect-carefully
    BrowserMatch " dolphin/" redirect-carefully

</VirtualHost>